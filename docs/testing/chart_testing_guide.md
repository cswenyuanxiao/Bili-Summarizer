# 图表生成功能测试指南

## 方式 1：使用真实视频测试（推荐）

寻找包含统计数据的 Bilibili 视频，例如：
- 销售数据分析视频
- 游戏数据对比视频（如不同角色的攻击力对比）
- 学习统计类视频（如"Python vs Java 性能对比"）
- 财经数据报告

示例搜索关键词：
- "数据分析"
- "对比评测"
- "销售额统计"
- "性能测试"

## 方式 2：临时强制启用（用于快速验证）

如果找不到合适的视频，可以暂时修改后端 Prompt 强制生成测试图表。

### 修改步骤：

1. 打开 `web_app/summarizer_gemini.py`

2. 在第 254 行附近（图表指令后面）添加一个强制示例：

```python
# 临时测试: 在 prompt_text 末尾添加
prompt_text += (
    "\n\n**测试要求**: 请根据视频内容生成一个示例图表。"
    "即使视频中没有明确数据，也请基于内容合理推断并生成一个柱状图或饼图。"
)
```

3. 重启后端服务（会自动热重载）

4. 提交任意视频链接

5. 查看是否出现 "📊 数据可视化" 面板

6. **测试完成后记得删除这段代码**

## 方式 3：使用模拟数据（最快）

直接在前端手动触发：

1. 打开浏览器开发者工具 Console

2. 在生成总结后，执行以下代码注入测试图表：

```javascript
// 模拟图表数据
const mockChartData = [
  {
    type: 'bar',
    title: '测试柱状图 - 各季度营收',
    data: {
      labels: ['Q1', 'Q2', 'Q3', 'Q4'],
      values: [100, 150, 200, 280]
    }
  },
  {
    type: 'pie',
    title: '测试饼图 - 市场份额',
    data: {
      labels: ['产品A', '产品B', '产品C'],
      values: [40, 35, 25]
    }
  }
];

// 注入到页面（需要在 Vue DevTools 中操作或修改组件）
// 或者直接在 HomePage.vue 中临时添加：
// chartData.value = mockChartData
```

## 验证检查清单

- [ ] 图表面板自动出现
- [ ] 图表标题正确显示
- [ ] 柱状图/饼图/折线图正确渲染
- [ ] 图表颜色美观
- [ ] 响应式布局正常（resize 窗口测试）
- [ ] 多个图表可以并排显示

## 预期效果

当 AI 检测到视频中有数值数据时，会在总结末尾生成类似这样的 JSON：

```json
{
  "charts": [
    {
      "type": "bar",
      "title": "2024年各季度销售额（万元）",
      "data": {
        "labels": ["第一季度", "第二季度", "第三季度", "第四季度"],
        "values": [120, 150, 180, 200]
      }
    }
  ]
}
```

后端会自动解析并存入 `usage.charts`，前端 `ChartPanel` 会自动渲染。

## 常见问题

**Q: 为什么没有生成图表？**
A: 大部分视频不包含明确的数值数据。AI 只会在检测到统计数据时才生成图表。

**Q: 图表数据不准确怎么办？**
A: 这是 AI 根据视频内容推断的，可能有误差。图表主要用于辅助理解，不应作为精确数据来源。

**Q: 可以手动触发图表生成吗？**
A: 目前是自动检测，未来可以考虑添加"强制生成图表"选项。

## 推荐测试视频类型

1. **数据分析类**：B站搜索 "Python 数据分析"
2. **产品对比类**：B站搜索 "手机性能对比"
3. **学习统计类**：B站搜索 "考研数学统计"
4. **财经类**：B站搜索 "股市数据分析"

---

**最后更新**: 2026-01-04  
**功能状态**: ✅ 已实现，等待真实场景验证
