# Bili-Summarizer é¡¹ç›®äº¤æ¥åŒ…

> **æœ€åæ›´æ–°**: 2025-12-26 06:25  
> **Tokenæ¶ˆè€—**: 85k/200k (42.5%)  
> **é˜¶æ®µ**: Phase 2 - åŠŸèƒ½æ‰©å±•

---

## 1. åŠŸèƒ½ç›®æ ‡ä¸éªŒæ”¶æ ‡å‡†

1. **è§†é¢‘æ€»ç»“**: è¾“å…¥Bç«™URL â†’ AIç”Ÿæˆæ€»ç»“+è½¬å½•+æ€ç»´å¯¼å›¾ âœ…
2. **è®¢é˜…æ¨é€**: å…³æ³¨UPä¸» â†’ æ¯æ—¥æ¨é€æ–°è§†é¢‘å¾…æ€»ç»“ âœ…
3. **çƒ­é—¨æ¨è**: å±•ç¤ºBç«™çƒ­é—¨è§†é¢‘ï¼Œä¸€é”®AIæ€»ç»“ âœ…
4. **æ”¶è—ç®¡ç†**: ä¿å­˜å–œæ¬¢çš„æ€»ç»“ï¼ˆåç«¯å·²å°±ç»ªï¼Œå‰ç«¯LocalStorageè¿‡æ¸¡ä¸­ï¼‰âœ…
5. **æ‰¹é‡å¤„ç†**: è¾“å…¥å¤šä¸ªURLå¹¶å‘æ€»ç»“ï¼ˆåç«¯åŸºç¡€æ¡†æ¶å·²å°±ç»ªï¼Œå‰ç«¯æ¨¡æ‹Ÿä¸­ï¼‰âœ…

---

## 2. æŠ€æœ¯æ ˆ & ç‰ˆæœ¬

### åç«¯
- **Python 3.10+** / FastAPI 0.100+
- **Supabase** (PostgreSQL + Auth)
- **httpx** (å¼‚æ­¥HTTP) + **APScheduler** (å®šæ—¶ä»»åŠ¡)
- **Gemini API** (AIæ€»ç»“)

### å‰ç«¯  
- **Vue 3.4+** / Vite 7.3 / TypeScript
- **Vue Router 4.x** / Pinia (çŠ¶æ€ç®¡ç†)
- **@heroicons/vue** (å›¾æ ‡) / Tailwindæ€æƒ³çš„è‡ªå®šä¹‰æ ·å¼

### è¿è¡Œç«¯å£
- åç«¯: `http://localhost:8000` (Docker & Local ç»Ÿä¸€)
- å‰ç«¯: `http://localhost:5173`

---

## 3. å…³é”®æ–‡ä»¶æ¸…å•

### åç«¯æ ¸å¿ƒ
```
web_app/
â”œâ”€â”€ main.py                    # FastAPIå…¥å£ï¼Œè·¯ç”±æ³¨å†Œï¼Œå¯åŠ¨è°ƒåº¦å™¨
â”œâ”€â”€ subscriptions.py           # Bç«™APIäº¤äº’ï¼šæœç´¢UPä¸»ã€è·å–è§†é¢‘ï¼ˆå«WBIç­¾å+é£æ§é‡è¯•ï¼‰
â”œâ”€â”€ routers/
â”‚   â”œâ”€â”€ subscriptions.py       # è®¢é˜…ç›¸å…³APIç«¯ç‚¹ï¼ˆæœç´¢/è®¢é˜…/åˆ—è¡¨/è§†é¢‘ï¼‰
â”‚   â”œâ”€â”€ trending.py            # çƒ­é—¨è§†é¢‘APIï¼ˆè°ƒç”¨Bç«™çƒ­é—¨æ¥å£ï¼‰
â”‚   â”œâ”€â”€ favorites.py           # æ”¶è—å¤¹API âœ…
â”‚   â””â”€â”€ __init__.py            # è·¯ç”±æ³¨å†Œä¸­å¿ƒ
â”œâ”€â”€ batch_summarize.py         # æ‰¹é‡å¤„ç†æœåŠ¡ (å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—) âœ…
â”œâ”€â”€ wbi.py                     # Bç«™WBIç­¾åå·¥å…·ï¼ˆé˜²é£æ§ï¼‰
â”œâ”€â”€ bilibili_rate_limiter.py   # ä»¤ç‰Œæ¡¶é™æµå™¨ï¼ˆæ–°å¢ï¼Œæœªé›†æˆï¼‰
â””â”€â”€ bilibili_cache.py          # è§†é¢‘åˆ—è¡¨ç¼“å­˜ï¼ˆæ–°å¢ï¼Œæœªé›†æˆï¼‰
```

### å‰ç«¯æ ¸å¿ƒ
```
frontend/src/
â”œâ”€â”€ App.vue                    # æ ¹ç»„ä»¶ï¼šå¯¼èˆªæ ï¼ˆå«"å·¥å…·é›†"ä¸‹æ‹‰èœå•ï¼‰
â”œâ”€â”€ router/index.ts            # è·¯ç”±é…ç½®ï¼š7ä¸ªé¡µé¢
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ HomePage.vue           # ä¸»é¡µï¼šURLè¾“å…¥+æ€»ç»“å±•ç¤º
â”‚   â”œâ”€â”€ TrendingPage.vue       # çƒ­é—¨æ¨èé¡µ âœ…
â”‚   â”œâ”€â”€ FavoritesPage.vue      # æ”¶è—å¤¹é¡µï¼ˆlocalStorageï¼‰ --> å¾…å¯¹æ¥åç«¯
â”‚   â”œâ”€â”€ BatchPage.vue          # æ‰¹é‡å¤„ç†é¡µï¼ˆå‰ç«¯æ¨¡æ‹Ÿï¼‰   --> å¾…å¯¹æ¥åç«¯
â”‚   â”œâ”€â”€ SubscriptionsPage.vue  # è®¢é˜…ç®¡ç†é¡µ âœ…
â”‚   â”œâ”€â”€ ComparePage.vue        # æ€»ç»“å¯¹æ¯”
â”‚   â””â”€â”€ TemplatesPage.vue      # è‡ªå®šä¹‰æ¨¡æ¿
â””â”€â”€ composables/
    â”œâ”€â”€ useAuth.ts             # Supabaseè®¤è¯
    â””â”€â”€ useSummarize.ts        # æ€»ç»“APIè°ƒç”¨
```

### é…ç½®æ–‡ä»¶
```
.env                           # ç¯å¢ƒå˜é‡ï¼šSUPABASE_URL, GEMINI_API_KEY, BILIBILI_SESSDATA(å¯é€‰)
frontend/vite.config.ts        # Viteä»£ç†é…ç½® â†’ localhost:8000
Dockerfile.backend             # åç«¯å®¹å™¨æ„å»º (å·²ç»Ÿä¸€ç«¯å£ 8000)
docker-compose.yml             # æœåŠ¡ç¼–æ’ (å·²ç»Ÿä¸€ç«¯å£ 8000)
```

---

## 4. å…³é”®æ¥å£ & æ•°æ®æ¨¡å‹

### åç«¯API
```python
# æœç´¢UPä¸»
GET /api/subscriptions/search?keyword={name}
â†’ {"users": [{"mid", "name", "avatar", "fans", "videos"}]}

# è·å–è®¢é˜…åˆ—è¡¨
GET /api/subscriptions
â†’ {"subscriptions": [{"id", "up_mid", "up_name", "created_at"}]}

# æ‰¹é‡æ€»ç»“
POST /batch-summarize
â†’ {"total": 5, "results": [...]}

# æ”¶è—å¤¹
GET /api/favorites
POST /api/favorites
DELETE /api/favorites/{id}
```

### å‰ç«¯æ•°æ®æ¨¡å‹
```typescript
// è®¢é˜…é¡¹
interface Subscription {
  id: string
  up_mid: string
  up_name: string
  up_avatar: string
  created_at: string
  videos?: Video[]        // æ‡’åŠ è½½
  videosLoading?: boolean
}

// Video, Favorite ç­‰
```

---

## 5. çº¦æŸä¸è¾¹ç•Œ

### æŠ€æœ¯çº¦æŸ
- âœ… **Bç«™APIé£æ§ä¸¥æ ¼**: å¿…é¡»ç”¨WBIç­¾å + çœŸå®Cookie + é™æµï¼Œå»ºè®®æ·»åŠ `BILIBILI_SESSDATA`åˆ°`.env`
- âœ… **Viteä»£ç†ç»‘å®š**: å‰ç«¯ç¡¬ç¼–ç ä»£ç†åˆ°`localhost:8000`ï¼Œåç«¯å·²ç»Ÿä¸€åˆ°`8000`
- âœ… **Supabase Auth**: æ‰€æœ‰éœ€ç™»å½•çš„ç«¯ç‚¹éœ€éªŒè¯`Authorization: Bearer <token>`

### æ€§èƒ½çº¦æŸ
- Bç«™APIè¯·æ±‚é—´éš”å»ºè®® â‰¥2sï¼ˆé¿å…-352é”™è¯¯ï¼‰
- è®¢é˜…æ£€æŸ¥å®šæ—¶ä»»åŠ¡ï¼šæ¯1å°æ—¶è¿è¡Œä¸€æ¬¡
- å•æ¬¡æ€»ç»“è€—æ—¶ï¼š30s-2minï¼ˆå–å†³äºè§†é¢‘é•¿åº¦ï¼‰

### ä¸å¯æ”¹åŠ¨è¾¹ç•Œ
- Supabaseæ•°æ®åº“schemaï¼ˆå·²ä¸Šçº¿ï¼‰
- WBIç­¾åç®—æ³•ï¼ˆBç«™åçˆ¬æœºåˆ¶ï¼‰
- Gemini APIè°ƒç”¨æ–¹å¼ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

---

## 6. å½“å‰çŠ¶æ€ & å¡ä½ç‚¹

### âœ… å·²å®Œæˆ
1. æ ¸å¿ƒæ€»ç»“åŠŸèƒ½ï¼ˆè§†é¢‘ â†’ æ€»ç»“+è½¬å½•+æ€ç»´å¯¼å›¾ï¼‰
2. è®¢é˜…ç³»ç»Ÿï¼ˆæœç´¢UPä¸»ã€å…³æ³¨ã€è·å–æ–°è§†é¢‘ï¼‰
3. çƒ­é—¨æ¨èé¡µï¼ˆå±•ç¤ºBç«™çƒ­æ¦œï¼‰
4. å¯¼èˆªæ ä¼˜åŒ–ï¼ˆemoji â†’ Heroiconsï¼Œåˆå¹¶"å·¥å…·é›†"ä¸‹æ‹‰èœå•ï¼‰
5. Bç«™é£æ§åŸºç¡€åº”å¯¹ï¼ˆWBIç­¾å + é‡è¯•é€»è¾‘ï¼‰
6. **ç¯å¢ƒç»Ÿä¸€**: Docker/Local åç«¯ç«¯å£ç»Ÿä¸€ä¸º 8000

### ğŸŸ¡ è¿›è¡Œä¸­
1. **Bç«™é£æ§ä¼˜åŒ–**: å·²åˆ›å»º`bilibili_rate_limiter.py`å’Œ`bilibili_cache.py`ï¼Œä½†**æœªé›†æˆåˆ°ä¸»ä»£ç **
2. **æ”¶è—å¤¹åŠŸèƒ½**: åç«¯APIå·²å®ç° (`favorites.py` + DBè¡¨)ï¼Œå‰ç«¯ç­‰å¾…å¯¹æ¥
3. **æ‰¹é‡å¤„ç†**: åç«¯å¼‚æ­¥æ¡†æ¶å·²å®ç° (`batch_summarize.py`)ï¼Œå‰ç«¯ç­‰å¾…å¯¹æ¥

### âŒ å½“å‰å¡ç‚¹
1. **Bç«™é£æ§æ—¶å¥½æ—¶å**: å»ºè®®ç«‹å³æ·»åŠ `BILIBILI_SESSDATA`ç¯å¢ƒå˜é‡ï¼ˆæˆåŠŸç‡95%+ï¼‰
2. **å›¾æ ‡è¿ç§»**: å·²å°†ä¸»è¦é¡µé¢emojiæ¢æˆHeroiconsï¼Œä½†`HomePage.vue`éƒ¨åˆ†Badgeä»ç”¨emoji

---

## 7. å¿«é€Ÿå¯åŠ¨å‘½ä»¤

```bash
# åç«¯ (æ¨è)
cd /Users/wenyuan/Desktop/summarizer
python -m uvicorn web_app.main:app --reload --port 8000

# æˆ–è€…ä½¿ç”¨ Docker
docker-compose up backend

# å‰ç«¯
cd frontend
npm run dev -- --port 5173

# è®¿é—®
open http://localhost:5173
```

---

## 8. ä¸‹ä¸€æ­¥å»ºè®®

**ä¼˜å…ˆçº§æ’åº**ï¼š
1. ğŸ”´ **æ·»åŠ SESSDATA** â†’ è§£å†³Bç«™é£æ§ï¼ˆ5åˆ†é’Ÿï¼Œé«˜æ”¶ç›Šï¼‰
2. ğŸŸ¢ **å¯¹æ¥æ”¶è—å¤¹** â†’ å‰ç«¯è°ƒç”¨æ–°API (FavoritesPage.vue)
3. ğŸŸ¢ **å¯¹æ¥æ‰¹é‡å¤„ç†** â†’ å‰ç«¯è°ƒç”¨ /batch-summarize (BatchPage.vue)
4. ğŸŸ¡ **é›†æˆé™æµå™¨** â†’ ä¼˜åŒ–Bç«™APIè°ƒç”¨

---

**å¦‚ä½•åœ¨æ–°å¯¹è¯ä½¿ç”¨æ­¤äº¤æ¥åŒ…**ï¼š
```
ä½ ï¼š"ç»§ç»­Bili-Summarizerå¼€å‘ï¼Œä¸Šä¸‹æ–‡è§é™„ä»¶ï¼ˆç²˜è´´æ­¤æ–‡ä»¶å†…å®¹ï¼‰"
AIï¼šå¿«é€Ÿæ¢å¤ä¸Šä¸‹æ–‡ï¼ˆçº¦5k tokenï¼‰ï¼Œç«‹å³å¼€å§‹å·¥ä½œ
```
